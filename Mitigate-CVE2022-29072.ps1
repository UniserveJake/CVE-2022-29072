$vulnerableHashes = -split $(Invoke-WebRequest https://raw.githubusercontent.com/tiktb8/CVE-2022-29072/main/sha256sums.txt -UseBasicParsing).content | ? {$_.length -eq 64} 

$drives = (Get-PSDrive -PSProvider FileSystem).Root
foreach($drive In $drives) {
    $chmFiles=(Get-ChildItem $Drive *.chm -file -Recurse -erroraction silentlycontinue | Get-ItemProperty).FullName | Select-Object -Unique    
    foreach ($chmFile in $chmFiles)
    {
        $hash = Get-FileHash -Path $chmFile -Algorithm SHA256
        if ($vulnerableHashes.Contains($hash.Hash))
        {
            Write-Output "Vulnerabile file found at $($chmFile)"
        }
    }   

 }